{include file="public/control_top.html"}
<div class="opTop">
	<a href="__APP__/index.php?s=Article/index">文章列表</a>
	<a href="__APP__/index.php?s=Article/add">发布新文章</a>
	<a href="__APP__/index.php?s=Article/recover">回收站</a>
</div>
<div class="captitle"><h5>文档列表 【目前共有{if $total}{$total}{else}0{/if}条文档】</h5></div>
<ul class="table_list_title">
	<li class="table_list_l table_list_l30"></li>
	<li class="table_list_l table_list_l50">ID</li>
	<li class="table_list_l table_list_l300">文档标题</li>
	<li class="table_list_l table_list_l150">更新时间</li>
	<li class="table_list_l table_list_l120">所属栏目</li>
	<li class="table_list_l table_list_l100">文档作者</li>
	<li class="table_list_l table_list_l80">点击数</li>
	<li class="table_list_l table_list_l80">评论数</li>
	{if $accessStatus == 1}
	<li class="table_list_l table_list_l120" accessStatus={$accessStatus}>操作</li>
	{/if}
</ul>
<div class="contentTableList">
    {if $dataList}
    {foreach $dataList as $d}
    <ul class="table_list">
		<li class="table_list_l table_list_l30">
			<input type="checkbox" name="archiveid[]" value="{$d.id}" flag="archiveID" class="checkbox" />
		</li>
		<li class="table_list_l table_list_l50">{$d.id}</li>
		<li class="table_list_l table_list_l300" title="{$d.title}">
			{$d.title}
		</li>
    	<li class="table_list_l table_list_l150">{$d.updatetime|mkdate}</li>
    	<li class="table_list_l table_list_l120">{$d.columnname}</li>
		<li class="table_list_l table_list_l100">{$d.author}</li>
		<li class="table_list_l table_list_l80">{$d.clicknum}</li>
		<li class="table_list_l table_list_l80">{$d.commentnum}</li>
    	{if $accessStatus == 1}
    	<li class="table_list_l table_list_l120" accessStatus={$accessStatus}>
    		<a href="__APPM__/index.php?s=Article/View&archiveid={$d.id}" target="_blank">预览</a>
    		<a href="__APP__/index.php?s=Article/edit&archiveid={$d.id}">修改</a>
    		<a delurl="__APP__/index.php?s=Article/recoverArticle&archiveid={$d.id}" href="javascript:;" name="del" msg="确定删除吗？">删除</a>
    	</li>
    	{/if}
    </ul>
    {/foreach}
    {else}
    <ul class="table_list"><li class="table_list_center">空</li></ul>
    {/if}
</div>
<div id="opBottom" class="opBottom">
	<a href="javascript:;" name="checkAll">全选</a>
	<a href="javascript:;" name="unCheckAll">取消</a>
	<a href="javascript:;" name="articleUpdate">更新</a>
	<a href="javascript:;" name="articleReview">审核</a>
	<a href="__APP__/index.php?s=Article/moveArticle" name="articleMove">移动</a>
	<a href="javascript:;" name="articleDelete">删除</a>
</div>
{include file="public/page.html"}
<link type="text/css" rel="stylesheet" href="public/plugin/colorbox/colorbox.css" media="screen">
<script type="text/javascript" src="public/plugin/colorbox/jquery.colorbox.js"></script>
<script type="text/javascript">
$(document).ready(function (){
var articleClass = function (){
	var articleObj = {
		checkAll: $("#opBottom a[name=checkAll]"),
		unCheckAll: $("#opBottom a[name=unCheckAll]"),
		articleUpdate: $("#opBottom a[name=articleUpdate]"),
		articleReview: $("#opBottom a[name=articleReview]"),
		articleMove: $("#opBottom a[name=articleMove]"),
		articleDelete: $("#opBottom a[name=articleDelete]")
	}
	var getArchiveID = function (){
		var archiveid= "";
		$("input[name='archiveid[]']").each(function (){
			if ($(this).attr("checked")) archiveid += archiveid ? ","+$(this).val() : $(this).val();
		});
		return archiveid;
	};
	articleObj.checkAll.click(function (){
		$("input[flag=archiveID]").attr("checked","checked");
	});
	articleObj.unCheckAll.click(function (){
		$("input[flag=archiveID]").attr("checked",false);
	});

	//移动栏目
	articleObj.articleMove.colorbox();
	articleObj.articleMove.click(function (){
		var archiveid = getArchiveID();
		$(this).attr("href",$(this).attr("href")+"&archiveid="+archiveid);
	});
	
	//删除文档
	articleObj.articleDelete.click(function (){
		var archiveid = getArchiveID();
		var d = {
			archiveid: archiveid
		};
		$.post("__APP__/index.php?s=Article/recoverArticle",d,function (data){
			alert(data.info);
			if (!data.status) location.href = location.href;
		},'json');
	});
}
articleClass();
});
</script>
{include file="public/control_bottom.html"}